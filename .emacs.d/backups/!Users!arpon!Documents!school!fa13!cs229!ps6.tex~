\input{preamble}

\title{CS 229, Problem Set 6}
\author{Arpon Raksit}
\date{29 Oct 2013}

\begin{document}
\maketitle
\thispagestyle{fancy}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\prob{1}

Let $A \coloneqq (\Pi U)^t (\Pi U) - I$. Note that $A$ is clearly
symmetric. Let $\lambda_1, \ldots, \lambda_d$ the eigenvalues of
$A$. Assume $|\lambda_1| \ge \cdots \ge |\lambda_d|$. Then we have
that $\|A\|^\ell = |\lambda_1|^\ell$ and $\tr(A^\ell) = \sum_{i=1}^d
\lambda_i^\ell$. Since $\ell$ is even it follows immediately that
$\|A\|^\ell \le \tr(A^\ell)$. Thus by Markov we have
\begin{equation}
\Pr_\Pi(\|A\| > \epsilon) \le \epsilon^{-\ell} \E_\Pi(\|A\|^\ell) \le
\epsilon^{-\ell} \E_\Pi(\tr(A^\ell)).
\end{equation}
Next, observe that
\[
\textstyle{\tr(A^2) = \tr(AA^t) = \|A\|_F^2 = \sum_{i,j=1}^d \left(
  \langle \Pi x_i, \Pi x_j \rangle - \delta_{i,j} \right)^2,}
\]
where $x_i$ is the $i$-th column of $U$ for $1 \le i \le d$. Let $D$
be the distribution of Thorup-Zhang. Precisely the proof from problem
set 1 that $\Pi \sim D$ preserves squared $\ell_2$-norm of vectors
(via straightforward expansion) gives also that
\[
\E_{\Pi \sim D}(\langle \Pi x_i, \Pi x_j \rangle) = \langle x_i, x_j
\rangle = \delta_{i,j} \quad\text{and}\quad \Var_{\Pi \sim D}(\langle
\Pi x_i, \Pi x_j \rangle) \le 2\|x_i\|^2\|x_j\|^2/m = 2/m,
\]
since $U$ is orthonormal. Finally by linearity of expectation this
gives us
\[
\textstyle{\E_{\Pi \sim D}(\tr(A^2)) = \sum_{i,j=1}^d \E_{\Pi \sim
    D}(\left( \langle \Pi x_i, \Pi x_j \rangle - \delta_{i,j}
  \right)^2 = \sum_{i,j=1}^d \Var_{\Pi \sim D}(\langle \Pi x_i, \Pi
  x_j \rangle) \le 2d^2/m}
\]
Combining this with (1) gives us the desired bound for $m \in
\Omega(d^2/(\epsilon^2\delta))$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\prob{2}

\subprob{a}

Let $X \in \mathcal{X}$. For $i \in [N]$ let $s(i) \in [k]$ the
cluster of $i$ in the relevant partition. By definition of $X$ we have
\[
(XX^t)_{ij} = \sum_{r=1}^k X_{ij}X_{jk} =
\frac{\delta_{s(i),s(j)}}{|S_{s(i)}|}.
\]
It follows that
\[
(A - XX^tA)_{ij} = A_{ij} - \sum_{r=1}^N
\frac{\delta_{s(i),s(r)}}{|S_{s(r)}|}A_{rj} = (p_i)_j -
\frac{1}{S_{s(i)}} \sum_{r \in S_{s(i)}} (p_r)_j.
\]
By problem 2(a) from problem set 4, it follows that $\|A -
XX^tA\|_F^2$ is precisely the $k$-means cost of the relevant
partition. \win

\subprob{b}

We first have the following.

\begin{lemma}
  Let $Y, Z \in \R^{\sigma \times \tau}$ such that $YZ^t = 0$. Then
  $\|Y + Z\|_F^2 = \|Y\|_F^2 + \|Z\|_F^2$.
\end{lemma}

\begin{proof}
  We have by linearity of trace and transpose that
  \begin{align*}
    \|Y + Z\|_F^2 &= \tr((Y+Z)(Y+Z)^t) = \tr(YY^t) + \tr(YZ^t) +
    \tr(ZY^t) + \tr(ZZ^t) \\ &= \|Y\|_F^2 + \|Z\|_F^2,
  \end{align*}
  since $YZ^t = ZY^t = 0$.
\end{proof}

\newcommand{\opt}{\mathrm{opt}}

Let $P \coloneqq X_\opt X_\opt^t$ and $\tilde P \coloneqq \tilde
X_\opt \tilde X_\opt^t$. Since $V$ is orthonormal, we have
\begin{align*}
  V_k^tV_{r-k} = 0 &\implies A_kA_{r-k}^t = 0 \implies (A_k - \tilde P
  A_k)(A_{r-k} - \tilde P A_{r-k})^t = 0.
\end{align*}
Then since $A = A_k + A_{r-k}$ it follows from the lemma that
\[
\|A - \tilde P A\|_F^2 = \|A_k - \tilde P A_k\|_F^2 + \|A_{r-k} -
\tilde P A_{r-k}\|_F^2.
\]
\win

\subprob{c}

Suppose $\left| \|\Pi B\|_F^2 - \|B\|_F^2 \right| > \epsilon
\|B\|_F^2$. Then clearly we must have
\[
\left| \|\Pi b\|_2^2 - \|b\|_2^2 \right| > \epsilon \|b\|_2^2 \implies
\left| \|\Pi x\|_2^2 - 1 \right| > \epsilon
\]
for some column $b$ of $B$, and $x \coloneqq b/\|b\|_2$. But $\|x\|_2
= 1$, so this can occur with probability at most $\delta$ when $\Pi
\sim D$, as shown in lecture (this is just from applying Markov to the
JL moment property).

\end{document}
