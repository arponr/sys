\input{preamble}

\title{CS 229, Problem Set 6}
\author{Arpon Raksit}
\date{29 Oct 2013}

\begin{document}
\maketitle
\thispagestyle{fancy}

\subsection*{Collaborators}
Martin Camacho, Aleksandar Makelov.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\prob{1}

Let $A \coloneqq (\Pi U)^t (\Pi U) - I$. Note that $A$ is clearly
symmetric. Let $\lambda_1, \ldots, \lambda_d$ the eigenvalues of
$A$. Assume $|\lambda_1| \ge \cdots \ge |\lambda_d|$. Then we have
that $\|A\|^\ell = |\lambda_1|^\ell$ and $\tr(A^\ell) = \sum_{i=1}^d
\lambda_i^\ell$. Since $\ell$ is even it follows immediately that
$\|A\|^\ell \le \tr(A^\ell)$. Thus by Markov we have
\begin{equation}
\Pr_\Pi(\|A\| > \epsilon) \le \epsilon^{-\ell} \E_\Pi(\|A\|^\ell) \le
\epsilon^{-\ell} \E_\Pi(\tr(A^\ell)).
\end{equation}
Next, observe that
\[
\textstyle{\tr(A^2) = \tr(AA^t) = \|A\|_F^2 = \sum_{i,j=1}^d \left(
  \langle \Pi x_i, \Pi x_j \rangle - \delta_{i,j} \right)^2,}
\]
where $x_i$ is the $i$-th column of $U$ for $1 \le i \le d$. Let $D$
be the distribution of Thorup-Zhang. Precisely the proof from problem
set 1 that $\Pi \sim D$ preserves squared $\ell_2$-norm of vectors
(via straightforward expansion) gives also that
\[
\E_{\Pi \sim D}(\langle \Pi x_i, \Pi x_j \rangle) = \langle x_i, x_j
\rangle = \delta_{i,j} \quad\text{and}\quad \Var_{\Pi \sim D}(\langle
\Pi x_i, \Pi x_j \rangle) \le 2\|x_i\|^2\|x_j\|^2/m = 2/m,
\]
since $U$ is orthonormal. Finally by linearity of expectation this
gives us
\[
\E_{\Pi \sim D}(\tr(A^2)) = \sum_{i,j=1}^d \E_{\Pi \sim D}(\left(
\langle \Pi x_i, \Pi x_j \rangle - \delta_{i,j} \right)^2 =
\sum_{i,j=1}^d \Var_{\Pi \sim D}(\langle \Pi x_i, \Pi x_j \rangle) \le
2d^2/m.
\]
Combining this with (1) gives us the desired bound for $m \in
\Omega(d^2/(\epsilon^2\delta))$. \win

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\prob{2}

\subprob{a}

Let $X \in \mathcal{X}$. For $i \in [N]$ let $s(i) \in [k]$ the
cluster index and $S(i) \coloneqq S_{s(i)}$ the cluster of $i$ in the
relevant partition. By definition of $X$ we have
\[
(XX^t)_{ij} = \sum_{r=1}^k X_{ij}X_{jk} =
\frac{\delta_{s(i),s(j)}}{|S(i)|}.
\]
It follows that
\[
(A - XX^tA)_{ij} = A_{ij} - \sum_{r=1}^N
\frac{\delta_{s(i),s(r)}}{|S(r)|}A_{rj} = (p_i)_j - \frac{1}{S(i)}
\sum_{r \in S(i)} (p_r)_j.
\]
By problem 2(a) from problem set 4, it follows that $\|A -
XX^tA\|_F^2$ is precisely the $k$-means cost of the relevant
partition. \win

\subprob{b}

We first have the following.

\begin{lemma}
  Let $Y, Z \in \R^{\sigma \times \tau}$ such that $YZ^t = 0$. Then
  $\|Y + Z\|_F^2 = \|Y\|_F^2 + \|Z\|_F^2$.
\end{lemma}

\begin{proof}
  We have by linearity of trace and transpose that
  \begin{align*}
    \|Y + Z\|_F^2 &= \tr((Y+Z)(Y+Z)^t) = \tr(YY^t) + \tr(YZ^t) +
    \tr(ZY^t) + \tr(ZZ^t) \\ &= \|Y\|_F^2 + \|Z\|_F^2,
  \end{align*}
  since $YZ^t = ZY^t = 0$.
\end{proof}

\newcommand{\opt}{\mathrm{opt}}

Let $P \coloneqq X_\opt X_\opt^t$ and $\tilde P \coloneqq \tilde
X_\opt \tilde X_\opt^t$. Since $V$ is orthonormal, we have
\begin{align*}
  V_k^tV_{r-k} = 0 &\implies A_kA_{r-k}^t = 0 \implies (A_k - \tilde P
  A_k)(A_{r-k} - \tilde P A_{r-k})^t = 0.
\end{align*}
Then since $A = A_k + A_{r-k}$ it follows from the lemma that
\[
\|A - \tilde P A\|_F^2 = \|A_k - \tilde P A_k\|_F^2 + \|A_{r-k} -
\tilde P A_{r-k}\|_F^2.
\]
So we just need to show $\|A_{r-k} - \tilde P A_{r-k}\|_F^2 \le \|A -
P A\|_F^2$.

\begin{lemma}
  Let $X \in \mathcal{X}$. Then $XX^t$ is a projection, and hence $I -
  XX^t$ is a projection.
\end{lemma}

\begin{proof}
  Notation as in the computation in part (a). We have
  \[
  ((XX^t)^2)_{ij} = \sum_{r=1}^n (XX^t)_{ir}(XX^t)_{rj} = \sum_{r=1}^n
  \frac{\delta_{s(i),s(r)}\cdot \delta_{s(r),s(j)}}{|S(i)| \cdot
    |S(j)|} = \frac{\delta_{s(i),s(j)}}{|S(i)|} = (XX^t)_{ij}.
  \]
  Thus $(XX^t)^2 = XX^t$, proving the claim.
\end{proof}

From the lemma we get that
\[
\|A_{r-k} - \tilde P A_{r-k}\|_F^2 = \|(I - \tilde P) A_{r-k}\|_F^2
\le \|A_{r-k}\|^2 = \|A - A_k\|_F^2.
\]
On the other hand since clearly $\rk(PA) \le \rk(P) \le k$, the
Schmidt approximation theorem gives that
\[
\|A - PA\|_F^2 \ge \|A - A_k\|^2,
\]
which finishes. \win

\subprob{c}

By rescaling it suffices to consider $B$ with $\|B\|_F^2 = 1$. Then by
linearity of trace and the triangle inequality we have
\[
\left| \|\Pi B\|_F^2 - \|B\|_F^2 \right| = |\tr((\Pi B)^t(\Pi B) - B^t
B)| \le \|(\Pi B)^t(\Pi B) - B^t B\|_F^2.
\]
By AMM (Lecture 13, Theorem 2), we have
\[
\Pr(\|(\Pi B)^t(\Pi B) - B^t B\|_F^2 > 9\epsilon^2\|B\|_F^4 =
9\epsilon^2) < \delta.
\]
Assuming $\epsilon < 1/9$, this gives the claim. \win

\subprob{d}

Let $P, \tilde P$ as in (b). By optimality of $\tilde X_\opt$ and (c)
we have
\[
\|A_k\Pi^t - \tilde P A_k \Pi^t\|_F^2 \le \|A_k\Pi^t - P A_k
\Pi^t\|_F^2 \le (1+\epsilon)\|A_k - PA_k\|_F^2 \le (1+\epsilon)\|A +
PA\|_F^2
\]
with probability at least $1 - \delta_1$. Then we just want to show
something like
\[
(1-\epsilon)\|A_k - \tilde P A_k \Pi^t\| \le \|A_k\Pi^t - \tilde P A_k
\Pi^t\|_F^2.
\]
I don't really know how to do this though. My intuition is that $\Pi$
being an $\epsilon$-subspace embedding for $V_k$ should let me
(approximately) take out the $V_k^t\Pi^t$ of the right-hand side of
that last inequality, but that's not exactly right. And I have no clue
why I should be using the low-rank approximation theorem (which surely
is where the $\sqrt{\epsilon/k}$ JLMP is coming from...).

\end{document}
